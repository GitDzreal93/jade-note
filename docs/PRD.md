# 基于 Markdown 的付费文档网站需求文档

## 1. 项目概述

本项目旨在开发一个基于 Markdown 格式的文档网站，用户可通过付费订阅解锁文档全部内容。系统采用纯前端技术栈实现，无需额外后端服务，方便部署在 Vercel 或 Cloudflare 等平台。同时，通过 Supabase 实现云数据库存储与用户认证，使用 Stripe 实现订阅与支付功能，并提供脚本自动将飞书内容转换为 Markdown 格式。

## 2. 核心功能

- **文档管理**
  - 使用 Markdown 格式编写文档
  - 部分内容免费展示，会员解锁后全部可见
  - 支持文档分页、搜索、目录自动生成

- **页面结构**
  - **首页**：品牌展示、最新/热门文档预览、导航入口
  - **定价页**：展示各个会员订阅套餐及优惠信息
  - **登录注册页**：用户注册、登录及密码找回（依托 Supabase Auth 实现）
  - **文档详情页**：Markdown 渲染文档，支持会员解锁付费内容的交互

- **会员与付费系统**
  - 集成 Supabase 与 Stripe，实现：
    - 会员订阅（按月/年）与支付
    - 购买后自动更新用户权限，解锁完整文档内容

- **自动化脚本**
  - 脚本将飞书文档内容转换为 Markdown 格式
  - 支持批量转换并导入文档库

## 3. 技术架构

### 3.1 前端框架

根据需求需要实现纯前端方案、支持 SSR/SSG、TypeScript 友好以及便于部署的特性，候选方案有：

- **Next.js（React）**
- **Nuxt.js（Vue）**
- **Vue3（纯 SPA 或结合 Vite）**

#### 对比分析：
- **Next.js**
  - **优点**：
    - 强大的 SSR/SSG 支持，利于 SEO 与首屏性能优化
    - 内置 TypeScript 支持，生态成熟
    - 与 Vercel 部署无缝对接
    - 丰富的插件和社区支持
  - **缺点**：
    - 对于纯静态内容可能稍显重量级，配置复杂度略高
- **Nuxt.js**
  - **优点**：
    - 同样支持 SSR/SSG，且基于 Vue 框架
    - Vue 生态友好，适合习惯 Vue 开发的团队
  - **缺点**：
    - 社区及插件数量略逊于 Next.js
    - 部署与构建优化上可能稍逊一筹（视具体版本而定）
- **Vue3（基于 Vite）**
  - **优点**：
    - 极快的热重载与构建速度，轻量灵活
    - 生态正在快速发展，适合纯前端 SPA
  - **缺点**：
    - SSR/SSG 配置需要借助 VitePress 或 Nuxt 进一步封装
    - 部署时可能需要额外处理 SEO 与性能优化

**推荐**：综合考虑项目对 SEO、TS 友好、扩展性及与 Vercel 部署的便捷性，**Next.js** 是更合适的选择。

### 3.2 文档页面框架选型

候选框架有：Nextra、Fumadocs、VitePress、Hexo。其中重点比较 **Fumadocs** 与 **VitePress**。

#### Fumadocs
- **优点**：
  - 基于 Next.js 开发，易于与 Next.js 项目无缝集成
  - 灵活可扩展，能够方便地嵌入自定义组件（例如会员付费提示、支付流程组件）
  - 对 TypeScript 支持良好
- **缺点**：
  - 社区与生态相对较新，文档和第三方插件资源相对有限

#### VitePress
- **优点**：
  - 轻量、快速，适合静态文档站点生成
  - 基于 Vite 构建，开发体验优异
  - 简洁、配置简单，适合纯文档展示
- **缺点**：
  - 扩展性较弱，不易嵌入复杂交互组件，定制化程度有限
  - 对于会员付费、交互式支付流程支持不如基于 Next.js 的框架

**比较结论**：对于需要集成会员、支付以及自定义交互的项目，**Fumadocs** 更易于扩展，且与 Next.js 技术栈契合，更适合本项目的需求。

### 3.3 第三方服务与库

- **云数据库与认证**：[Supabase](https://supabase.com)
  - 使用 supabase-js 库进行前端调用
  - Supabase Auth 实现用户登录、注册、权限管理
- **支付与订阅**：[Stripe](https://stripe.com)
  - 使用 Stripe 官方 SDK 集成订阅及支付功能
- **Markdown 渲染**：
  - Next.js 页面中使用 remark、rehype 等库进行 Markdown 渲染与自定义扩展
- **UI 组件与样式**：
  - 推荐使用 [Tailwind CSS](https://tailwindcss.com) 快速构建响应式 UI
  - 结合 UI 库（如 Radix UI、Headless UI）提升组件交互性
- **自动化转换脚本**：
  - Node.js 脚本使用 Feishu API 或 HTML 转 Markdown 的库（如 Turndown）
  - 脚本独立运行，用于定时或手动更新文档内容

## 4. 系统架构图

```
┌─────────────────────────────┐
│       用户浏览器            │
│  (Next.js 前端展示 & 交互)   │
└─────────────┬───────────────┘
              │
              │调用 Supabase & Stripe API
              │
┌─────────────▼───────────────┐
│         第三方服务          │
│ ┌─────────┐ ┌─────────────┐ │
│ │Supabase │ │   Stripe    │ │
│ │ (数据库 │ │ (支付与订阅)│ │
│ │ 认证)    │ │             │ │
│ └─────────┘ └─────────────┘ │
└─────────────┬───────────────┘
              │
              │自动转换脚本（Node.js）
              │
┌─────────────▼───────────────┐
│      飞书文档内容           │
└─────────────────────────────┘
```

## 5. 详细页面设计

### 5.1 首页
- 介绍品牌、特色功能、最新文档列表、会员优惠介绍
- 导航入口：文档、定价、登录/注册等

### 5.2 定价页
- 展示不同会员套餐（如月度、年度）
- 详细描述各套餐功能及优势
- Stripe 支付按钮与弹窗

### 5.3 登录/注册页
- 使用 Supabase Auth 提供用户登录、注册、密码找回
- 支持社交登录（如 Google、GitHub，可选）

### 5.4 文档详情页
- Markdown 渲染文档内容
- 免费预览部分与付费解锁内容的区分展示
- 用户会员状态判断逻辑与交互提示

## 6. 自动转换脚本

- 使用 Node.js 编写脚本
- 通过 Feishu 提供的 API 或爬虫技术获取飞书文档内容
- 利用 Turndown 等工具将 HTML 转为 Markdown 格式
- 生成 Markdown 文件后自动更新到文档仓库或触发重新构建

## 7. 部署方案

- **部署平台**：Vercel 或 Cloudflare Pages（纯前端项目均可支持 SSR/SSG 部署）
- **CI/CD 集成**：利用 GitHub Actions 进行自动化部署
- **静态资源管理**：使用 CDN 加速，Tailwind CSS 构建后上传至部署平台

## 8. 风险与注意事项

- **会员支付与权限同步**：确保 Stripe 与 Supabase 之间的数据联动准确
- **文档扩展性**：选型 Fumadocs 时需关注其生态更新及社区支持
- **自动转换脚本稳定性**：确保飞书 API 变更时脚本可及时调整
- **安全性**：前端纯部署场景下，需特别关注 Supabase 认证与 Stripe 支付的安全配置

## 9. 开发计划与里程碑

1. **需求分析与技术选型**（1 周）
2. **项目基础搭建（Next.js + Fumadocs 框架整合）**（2 周）
3. **页面与功能开发**：
   - 首页、定价页、登录/注册页（2 周）
   - 文档详情页（2 周）
4. **会员支付功能集成（Supabase + Stripe）**（2 周）
5. **自动化脚本开发与测试**（1 周）
6. **系统测试与部署**（1 周）
7. **上线与后续优化**

---

## 10. 总结与推荐

- **前端框架**：选择 **Next.js**，原因在于其成熟的 SSR/SSG 能力、对 TypeScript 的友好支持以及与 Vercel 的无缝部署。
- **文档框架**：在文档页面的选型上，**Fumadocs** 相较于 VitePress 更易于扩展，能更好地嵌入定制化功能（如会员付费、交互组件），符合项目复杂交互与业务需求。
- **其他关键技术**：
  - Supabase 作为云数据库与用户认证平台
  - Stripe 用于支付与订阅管理
  - Tailwind CSS 及 UI 组件库实现快速开发

以上方案整体实现了“纯前端、便捷部署、扩展性强”的目标，能够满足 Markdown 文档展示、会员付费与自动转换脚本等全方位需求。

---